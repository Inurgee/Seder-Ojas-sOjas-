def derive_policy(state, sleep_pressure, threat_score):
    policy = {
        "global": {},
        "immune_layer": {},
        "somatic_layer": {},
        "cognitive_layer": {},
        "substrate": {},
        "spore_protocol": {},
    }

    if state == SystemState.CALM:
        _policy_calm(policy, sleep_pressure)
    elif state == SystemState.ALERT:
        _policy_alert(policy, threat_score)
    elif state == SystemState.FLOW:
        _policy_flow(policy)
    elif state == SystemState.RECOVERY:
        _policy_recovery(policy)

    return policy
